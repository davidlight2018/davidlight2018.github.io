<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    
    
        
            
                <link rel="shortcut icon" href="/images/favicon.ico">
            
        
        
            
                <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
            
        
        
            
                <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
            
        
    
    <!-- title -->
    <title>『CS228笔记』Representaion ── Bayesian Networks</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+SC&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@2/distr/fira_code.css" rel="stylesheet">
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="max-width mx-auto px3 ltr">

    <div id="header-post">
    <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
    <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
    <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i
                class="fas fa-chevron-up fa-lg"></i></a>
    <span id="menu">
    <span id="nav">
      <ul>
          
              <li><a href="/">Home</a></li>
          
              <li><a href="/archives/">Articles</a></li>
          
              <li><a href="/category/">Category</a></li>
          
              <li><a href="/tags/">Tag</a></li>
          
              <li><a href="/about/">About</a></li>
          
              <li><a href="/search/">Search</a></li>
          
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
          
          
              <li><a class="icon" href="/2020/05/11/cs228_inference_variable_elimination/"><i class="fas fa-chevron-right"
                                                                           aria-hidden="true"
                                                                           onmouseover="$('#i-next').toggle();"
                                                                           onmouseout="$('#i-next').toggle();"></i></a></li>
          
          <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i
                          class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();"
                          onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true"
                                        onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();"
                                        onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
    <li><a class="icon"
           href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.tsinghua2018.top/2020/05/11/cs228_representation_bayesian_networks/&title=『CS228笔记』Representaion ── Bayesian Networks"><i
                    class="fab fa-qq " aria-hidden="true"></i></a></li>
    <li><a class="icon"
           href="https://service.weibo.com/share/share.php?url=http://blog.tsinghua2018.top/2020/05/11/cs228_representation_bayesian_networks/&title=『CS228笔记』Representaion ── Bayesian Networks"><i
                    class="fab fa-weibo " aria-hidden="true"></i></a></li>
    <li><a class="icon" href="https://twitter.com/share?url=http://blog.tsinghua2018.top/2020/05/11/cs228_representation_bayesian_networks/&text=『CS228笔记』Representaion ── Bayesian Networks" target="_blank" rel="noopener"><i
                    class="fab fa-twitter " aria-hidden="true"></i></a></li>
    <li><a class="icon" href="mailto:?subject=『CS228笔记』Representaion ── Bayesian Networks&body=Check out this article: http://blog.tsinghua2018.top/2020/05/11/cs228_representation_bayesian_networks/"><i
                    class="fas fa-envelope " aria-hidden="true"></i></a></li>
</ul>
    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#贝叶斯网络的概率建模"><span class="toc-number">1.</span> <span class="toc-text">贝叶斯网络的概率建模</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#图的表示"><span class="toc-number">1.1.</span> <span class="toc-text">图的表示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#正式定义"><span class="toc-number">1.2.</span> <span class="toc-text">正式定义</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#贝叶斯网络的依赖关系"><span class="toc-number">2.</span> <span class="toc-text">贝叶斯网络的依赖关系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#有向图描述的独立变量"><span class="toc-number">2.1.</span> <span class="toc-text">有向图描述的独立变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有向图的表示能力"><span class="toc-number">2.2.</span> <span class="toc-text">有向图的表示能力</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

<div class="content index py4">
    
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        
    <h1 class="posttitle" itemprop="name headline">
        『CS228笔记』Representaion ── Bayesian Networks
    </h1>

        <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">
            David
            
        </span>
      </span>
            
    <div class="postdate">
        
            <time datetime="2020-05-11T11:44:41.000Z"
                  itemprop="datePublished">2020-05-11</time>
            
                (Updated:
                <time datetime="2020-05-12T12:02:40.000Z"
                      itemprop="dateModified">2020-05-12</time>)
            
        
    </div>

            
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/CS228-%E7%AC%94%E8%AE%B0/">CS228 笔记</a>
    </div>

            
        </div>
    </header>
    
    <div class="content" itemprop="articleBody">
        <blockquote>
<p>以下内容翻译自 <a href="https://ermongroup.github.io/cs228-notes/" target="_blank" rel="noopener">CS228 课程</a>。</p>
</blockquote>
<p>我们从 Representaion 的主题开始：我们如何选择概率分布来模拟世界中的某些有趣方面？提出一个好的模型并不总是那么容易：在引言中我们已经看到，一个简单的垃圾邮件分类模型将要求我们指定许多参数，这些参数的英文单词数量成倍增加。</p>
<p>在本章中，我们将学习避免此类复杂的一种方法。我们准备：</p>
<ul>
<li>了解仅使用几个参数来对概率分布进行参数化的有效且通用的技术。</li>
<li>了解如何通过有向无环图（DAG）优雅地描述生成的模型。</li>
<li>研究 DAG 的结构和其描述的分布所做的建模假设之间的联系；这不仅将使这些建模假设更加明确，还将帮助我们设计更有效的推理算法。</li>
</ul>
<p>我们将在这里看到的各种模型称为贝叶斯网络。在下一章中，我们还将看到第二种方法，该方法涉及无向图，也称为马尔可夫随机场（MRF）。贝叶斯网络有效地显示了因果关系，而 MRF 却不能。因此，对于随机变量之间没有明确因果关系的问题，MRF 将更加适合。</p>
<h2 id="贝叶斯网络的概率建模">贝叶斯网络的概率建模</h2>
<p>有向图模型（也称为贝叶斯网络）是一类概率分布，它们允许使用有向图描述紧致的参数化。该参数化背后的总体思路非常简单。</p>
<p>回想一下，通过链式法则，我们可以将任何概率 <span class="math inline">\(p\)</span> 表示为： <span class="math display">\[
p\left(x_{1}, x_{2}, \ldots, x_{n}\right)=p\left(x_{1}\right) p\left(x_{2} | x_{1}\right) \cdots p\left(x_{n} | x_{n-1}, \ldots, x_{2}, x_{1}\right)
\]</span> 紧致的贝叶斯网络是一种分布，其中右侧的每个因子仅取决于少量的祖先变量 <span class="math inline">\(x_{A_i}\)</span>： <span class="math display">\[
p\left(x_{i} | x_{i-1}, \ldots, x_{1}\right)=p\left(x_{i} | x_{A_{i}}\right)
\]</span> 例如，在具有五个变量的模型中，我们可以选择使用因数 <span class="math inline">\(p(x_5|x_4, x_3)\)</span> 来近似 <span class="math inline">\(p(x_5|x_4,x_3,x_2,x_1)\)</span>。在这种情况下，我们让 <span class="math inline">\(x_{A_5}=\{x_4,x_3\}\)</span>。</p>
<p>当变量是离散时（也是我们讨论的大多数情况），我们可以将因数 <span class="math inline">\(p(x_i|x_{A_i})\)</span> 视作一张概率表，其中行对应的是 <span class="math inline">\(x_{A_i}\)</span> 的赋值，列对应的是 <span class="math inline">\(x_i\)</span> 的值；每个条目包含 <span class="math inline">\(p(x_i|x_{A_i})\)</span> 的实际概率。如果每个变量有 <span class="math inline">\(d\)</span> 个取值，而且最多有 <span class="math inline">\(k\)</span> 个祖先，则整张表最多包含 <span class="math inline">\(O(d^{k+1})\)</span> 个条目。同时，对于每个变量我们只有一张概率表，因此只需用 <span class="math inline">\(O(nd^{k+1})\)</span> 个参数就可以紧致的描述整个概率分布（而朴素的方法需要 <span class="math inline">\(O(d^n)\)</span>）。</p>
<h3 id="图的表示">图的表示</h3>
<p>这种形式的分布自然可以表示为有向无环图，其中顶点对应于变量 <span class="math inline">\(x_i\)</span>，而边表示依赖关系。特别地，我们将每个节点 <span class="math inline">\(x_i\)</span> 的父节点设置为其祖先 <span class="math inline">\(x_{A_i}\)</span>。</p>
<p>考虑如下的例子，某学生在一场考试中的分数 <span class="math inline">\(g\)</span>，取决于考试的难度 <span class="math inline">\(d\)</span> 和学生的智力 <span class="math inline">\(i\)</span>，同时也影响着该课程教授的推荐信质量 <span class="math inline">\(l\)</span>。同时学生的智力 <span class="math inline">\(i\)</span> 影响着 SAT 的分数 <span class="math inline">\(s\)</span>。每个变量都是二元变量，除了 <span class="math inline">\(g\)</span> 有三种可能的取值。这 5 个变量的联合概率分布可以自然的分解为： <span class="math display">\[
p(l, g, i, d, s)=p(l | g) p(g | i, d) p(i) p(d) p(s | i)
\]</span> 该分布的图形表示形式是 DAG，它直观地表明了随机变量如何相互依赖：推荐信取决于分数，而分数又取决于学生的智力和考试难度。</p>
<p><img src="https://ermongroup.github.io/cs228-notes/assets/img/grade-model.png" style="zoom:45%;" /></p>
<center style="font-size:16px;color:#808080;text-decoration:underline">
贝叶斯网络模型描述学生在考试中的表现，<br>分布可以表示为特定表的条件概率分布的乘积，<br>这些分布的形式由图中的边来描述。
</center>
<p>解释有向图的另一种方法是根据故事来说明如何生成数据。在上面的示例中，为了确定推荐信的质量，我们可以首先对智力水平和考试难度进行抽样；然后，根据这些参数对学生的成绩进行抽样；最后根据该成绩生成推荐信。</p>
<p>在前面的垃圾邮件分类示例中，我们隐式地假定电子邮件是根据两步过程生成的：首先，我们选择垃圾邮件/非垃圾邮件的标签 <span class="math inline">\(y\)</span>，然后我们以该标签为条件，独立采样每个单词是否存在。</p>
<h3 id="正式定义">正式定义</h3>
<p>正式来说，贝叶斯网络是一个有向图 <span class="math inline">\(G=(V, E)\)</span>，包含以下条件：</p>
<ul>
<li>每个节点都是一个随机变量 <span class="math inline">\(x_i\)</span>，其中 <span class="math inline">\(i \in V\)</span></li>
<li>每个节点都有一个条件概率分布（conditional probability distribution, CPD）<span class="math inline">\(p(x_i|x_{A_i})\)</span>，表示 <span class="math inline">\(x_i\)</span> 的概率取决于其父节点的值。</li>
</ul>
<p>因此，贝叶斯网络定义了一个概率分布 <span class="math inline">\(p\)</span>。相反，我们说，如果给定有向无环图 G，概率 <span class="math inline">\(p\)</span> 可以分解为 G 中因子的乘积，则概率 <span class="math inline">\(p\)</span> 可以在 G 上分解。</p>
<p>不难发现，由贝叶斯网络表示的概率是有效的：显然，它是非负的，并且可以使用归纳论证（并使用 CPD 为有效概率这一事实）来证明所有变量值的总和为 1。相反，我们还可以通过反例说明，当 G 包含循环时，其关联的概率的和可能不等于 1。</p>
<h2 id="贝叶斯网络的依赖关系">贝叶斯网络的依赖关系</h2>
<p>总而言之，贝叶斯网络可以通过较小的、局部的条件概率分布（每个变量 1 个）的乘积形成的概率分布来表示。通过以这种形式表示概率，我们将某些变量是独立的引入到模型的假设中。</p>
<p>这就提出了一个问题：通过使用给定结构 G 描述的贝叶斯网络模型，我们确切地做出了哪些独立性假设？这个问题之所以重要有以下两个原因：我们应该确切地知道我们在做哪些模型假设（以及它们是否正确）；同样，此信息将有助于稍后更有效的推理算法。</p>
<p>我们使用符号 <span class="math inline">\(I(p)\)</span> 表示联合分布 <span class="math inline">\(p\)</span> 中所有独立变量的集合。例如，如果有 <span class="math inline">\(p(x, y)=p(x)p(y)\)</span>，则我们说 <span class="math inline">\(x \perp y \in I(p)\)</span>。</p>
<h3 id="有向图描述的独立变量">有向图描述的独立变量</h3>
<p>事实证明，贝叶斯网络 <span class="math inline">\(p\)</span> 非常优雅地描述了 <span class="math inline">\(I(p)\)</span> 中的多种独立性；通过查看三种类型的结构，可以从图中恢复这些独立性。</p>
<p>为简单起见，我们先来看一下具有三个节点 X, Y, Z 的贝叶斯网络 G。在这种情况下，G 本质上只有三个可能的结构，每个结构都导致不同的独立性假设。有兴趣的读者可以使用一些代数知识轻松证明这些结果。</p>
<p><img src="https://ermongroup.github.io/cs228-notes/assets/img/3node-bayesnets.png" style="zoom:70%;" /></p>
<ul>
<li>Cascade（级联）：如果 G 的结构为 <span class="math inline">\(X \to Z \to Y\)</span>，如图 (a) 和 (b)。若 <span class="math inline">\(Z\)</span> 是可以被观察到的，则 <span class="math inline">\(X \perp Y\;|\;Z\)</span>；但是若 <span class="math inline">\(Z\)</span> 是不可观察到的，则 <span class="math inline">\(X \not\perp Y\)</span>。这里，直觉上来说，<span class="math inline">\(Z\)</span> 掌握着所有决定 <span class="math inline">\(Y\)</span> 输出的所有信息，因此 <span class="math inline">\(X\)</span> 的取值并不重要。</li>
<li>Common parent（共同父节点）：若 G 的结构为 <span class="math inline">\(X \gets Z \to Y\)</span>，如图 (c)。若 <span class="math inline">\(Z\)</span> 是可以被观察到的，则 <span class="math inline">\(X \perp Y\;|\;Z\)</span>；若 <span class="math inline">\(Z\)</span> 是不可观察到的，则 <span class="math inline">\(X \not\perp Y\)</span>。从直觉上将，这是因为 <span class="math inline">\(Z\)</span> 包含了决定 <span class="math inline">\(X\)</span> 和 <span class="math inline">\(Y\)</span> 结果的所有信息，一旦观察到，没有其他因素会影响这些变量的结果。</li>
<li><span class="math inline">\(V\)</span>-structure（又被称为 explaining away）：若 G 的结构为 <span class="math inline">\(X \to Z \gets Y\)</span>，如图 (d) 所示。那么已知的 <span class="math inline">\(Z\)</span> 关联着 <span class="math inline">\(X\)</span> 和 <span class="math inline">\(Y\)</span>。换句话说，若 <span class="math inline">\(Z\)</span> 是不可观察的，则<span class="math inline">\(X \perp Y\)</span>，但是若 <span class="math inline">\(Z\)</span> 是可观察的，那么 <span class="math inline">\(X \not\perp Y\;|\;Z\)</span>。</li>
</ul>
<p>最后一种情况需要进一步说明。假设 <span class="math inline">\(Z\)</span> 是一个布尔变量，它表示我们的草坪在早晨是否潮湿。<span class="math inline">\(X\)</span> 和 <span class="math inline">\(Y\)</span> 是潮湿的两种解释：要么下雨了（由 <span class="math inline">\(X\)</span> 表示），要么是洒水喷头打开了（由 <span class="math inline">\(Y\)</span> 表示）。如果我们知道草坪是湿的（<span class="math inline">\(Z\)</span> 为真），并且洒水喷头没有运转（<span class="math inline">\(Y\)</span> 为假），则 <span class="math inline">\(X\)</span> 为真的概率必须为 1，因为这是唯一可能的解释。因此，给定 <span class="math inline">\(Z\)</span>，<span class="math inline">\(X\)</span> 和 <span class="math inline">\(Y\)</span> 不是独立的。</p>
<p>这些结构清楚地描述了由三个变量组成的贝叶斯网络编码的独立性。通过将它们递归地应用于任何较大的图，我们可以将它们扩展到通用网络。这引出了一个称为 <span class="math inline">\(d\)</span>-separated 的概念（其中 <span class="math inline">\(d\)</span> 表示有向）。</p>
<p>另 <span class="math inline">\(Q, W\)</span> 和 <span class="math inline">\(O\)</span> 为贝叶斯网络 G 中的三组节点。我们说，给定 <span class="math inline">\(Q\)</span>（即变量 <span class="math inline">\(O\)</span> 是可观察的），<span class="math inline">\(Q\)</span> 和 <span class="math inline">\(W\)</span> 是 <span class="math inline">\(d\)</span>-separated，若 <span class="math inline">\(Q\)</span> 和 <span class="math inline">\(W\)</span> 没有通过 active path 连接。给定观察变量 <span class="math inline">\(O\)</span>，则对于路径中的连续三个变量 <span class="math inline">\(X, Y, Z\)</span>，如果满足以下条件之一，则 G 中的无向路径称为 active path：</p>
<ul>
<li><span class="math inline">\(X \gets Z \gets Y\)</span>，而且 <span class="math inline">\(Z\)</span> 是不可观察的</li>
<li><span class="math inline">\(X \to Z \to Y\)</span>，而且 <span class="math inline">\(Z\)</span> 是不可观察的</li>
<li><span class="math inline">\(X \gets Z \to Y\)</span>，而且 <span class="math inline">\(Z\)</span> 是不可观察的</li>
<li><span class="math inline">\(X \to Z \gets Y\)</span>，而且 <span class="math inline">\(Z\)</span> 以及其子孙都是可观察的</li>
</ul>
<p>举个例子，如下图所示，若给定 <span class="math inline">\(X_2, X_3\)</span>，则 <span class="math inline">\(X_1\)</span> 和 <span class="math inline">\(X_6\)</span> 是 <span class="math inline">\(d\)</span>-separated 的。然而，当给定 <span class="math inline">\(X_1, X_6\)</span>，<span class="math inline">\(X_2\)</span> 和 <span class="math inline">\(X_3\)</span> 则不是 <span class="math inline">\(d\)</span>-separated 的，因为存在 active path（V-structure <span class="math inline">\(X_2, X_6, X_5, X_3\)</span>）。</p>
<p><img src="https://ermongroup.github.io/cs228-notes/assets/img/dsep2.png" style="zoom:50%;" /></p>
<p><span class="math inline">\(d\)</span>-sapated 的概念很有用，因为它让我们可以描述模型中大部分的依赖关系。我们让 <span class="math inline">\(I(G)=\{(X \perp Y \;|\; Z): X,Y \text{are}\;d\text{-sep given}\;Z\}\)</span> 表示 G 中 d-separated 变量的集合。</p>
<p><strong>定理</strong>：若 <span class="math inline">\(p\)</span> 可以在 G 上分解，则 <span class="math inline">\(I(G) \subseteq I(p)\)</span>。这种情况，我们说 G 是 <span class="math inline">\(p\)</span> 的 <span class="math inline">\(I\)</span>-map（independence map）。</p>
<blockquote>
<p>我们不在这里正式的证明它，但是直观上来说，若 <span class="math inline">\(X, Y\)</span> 和 <span class="math inline">\(Y, Z\)</span> 都是互相独立的，则 <span class="math inline">\(X, Z\)</span> 也是互相独立的。因此，我们可以查看相邻节点并根据上面概述的局部依赖关系结构传播依赖关系。</p>
</blockquote>
<p>换句话说，G 中编码的所有独立性都是合理的：G 中是 d-separated 的变量在 p 中是真正独立的。但是，事实并非如此：一个分布可以在 G 中分解，但是可能具有 G 中未捕获的独立性。</p>
<p>从某种意义上来说，这几乎是一个琐碎的声明。若 <span class="math inline">\(p(x, y)=p(x)p(y)\)</span>，则此分布仍会在图 <span class="math inline">\(y \to x\)</span> 上分解，因为我们总能将其写为 <span class="math inline">\(p(x, y)=p(x|y)p(y)\)</span>，其中条件概率 <span class="math inline">\(p(x|y)\)</span> 中 <span class="math inline">\(x\)</span> 的概率实际上并不会受 <span class="math inline">\(y\)</span> 的影响。但是，我们可以通过简单地删除不必要的边来构造与 <span class="math inline">\(p\)</span> 的结构相匹配的图。</p>
<h3 id="有向图的表示能力">有向图的表示能力</h3>
<p>这就引出了我们最后一个，也许也是最重要的问题：有向图能否表达任何分布 <span class="math inline">\(p\)</span> 中的所有独立性？更正式地说，给定分布 <span class="math inline">\(p\)</span>，我们能否构造图 G 使得 <span class="math inline">\(I(G)=I(p)\)</span>？</p>
<p>首先，构造一个图 G 满足 <span class="math inline">\(I(G) \subseteq I(p)\)</span> 是很容易的。一个全连接的有向图 G 是任何分布的 <span class="math inline">\(I\)</span>-map，因为 <span class="math inline">\(I(G)=\phi\)</span>。</p>
<p><img src="https://ermongroup.github.io/cs228-notes/assets/img/full-bayesnet.png" style="zoom:50%;" /></p>
<center style="font-size:16px;color:#808080;text-decoration:underline">
A fully connected Bayesian network over four variables. <br>There are no independencies in this model,<br>and it is an I-map for any distribution
</center>
<p>一个更有趣的问题是，我们是否可以为 <span class="math inline">\(p\)</span> 找到一个最小的 <span class="math inline">\(I\)</span>-map，这样从 G 中删除任何一条边都将导致它不再是 <span class="math inline">\(I\)</span>-map。很容易的一个方法是：我们可以从完全连接的 G 开始，然后移除边，直到 G 不再是 <span class="math inline">\(I\)</span>-map。一种方法是遵循图的自然拓扑顺序，并删除节点祖先，直到不可删除为止。在进行结构学习时，我们将在课程结束时重新审视此修剪方法。</p>
<p>但是，我们真正感兴趣的是，概率分布 <span class="math inline">\(p\)</span> 是否具有理想的映射 G 使得 <span class="math inline">\(I(p)=I(G)\)</span>。不幸的是，答案是否定的。例如，考虑以下关于三个变量 <span class="math inline">\(X, Y, Z\)</span> 的分布 <span class="math inline">\(p\)</span>，我们从伯努利分布中采样 <span class="math inline">\(X, Y \sim \operatorname{Ber}(0.5)\)</span>，并设 <span class="math inline">\(Z= X\; \text{xor}\; Y\)</span>（我们称之为 noizy-xor 示例）。我们可以使用代数 <span class="math inline">\(\{X \perp Y, Z \perp Y, X \perp Z\} \in I(p)\)</span> 以及 <span class="math inline">\(Z \perp\{Y, X\} \notin I(p)\)</span> 来检验。因此，尽管 <span class="math inline">\(X \to Z \gets Y\)</span> 是分布 <span class="math inline">\(p\)</span> 的 <span class="math inline">\(I\)</span>-map，但是我们讨论的 3-节点图结构都不能完美描述 <span class="math inline">\(I(p)\)</span>，因此该分布没有理想的映射。</p>
<p>一个相关的问题是，完美映射的存在是否唯一。同样，情况并非如此，因为 <span class="math inline">\(X \to Y\)</span> 和 <span class="math inline">\(X \gets Y\)</span> 编码相同的独立性，但形成不同的图。更一般地说，若两个贝叶斯网络 <span class="math inline">\(G_1, G_2\)</span> 编码相同的依赖关系使得 <span class="math inline">\(I(G_1)=I(G_2)\)</span>，则它们是 <span class="math inline">\(I\)</span>-equivalent 的。</p>
<p>两个贝叶斯网络何时是 <span class="math inline">\(I\)</span>-equivalent 的？为了回答这个问题，让我们回到一个包含三个变量的简单示例。下面的每个图形都拥有相同的骨架，这意味着，如果我们放下箭头的方向性，则在每种情况下，我们都将获得相同的无向图。</p>
<p>级联结构 (a) (b) 显然是对称的，箭头的方向无关紧要。实际上，(a) (b) (c) 编码完全相同的依赖项。只要不将箭头变成 V-structrue (d)。但是，当我们具有 V-structrue 时，就不能更改任何箭头：结构 (d) 是唯一描述依赖项 <span class="math inline">\(X \not\perp Y\;|\;Z\)</span>。这些示例为以下关于 <span class="math inline">\(I\)</span>-equivalent 的一般结果提供了直观认识。</p>
<p><img src="https://ermongroup.github.io/cs228-notes/assets/img/3node-bayesnets.png" style="zoom:70%;" /></p>
<p><strong>定理</strong>：若 <span class="math inline">\(G, G&#39;\)</span> 具有相同骨架和相同的 v-structures，则 <span class="math inline">\(I(G)=I(G&#39;)\)</span>。</p>
<p>同样，很容易直观地理解为什么是这样。如果两个图中变量之间的 <span class="math inline">\(d\)</span>-separated 相同，则它们是 <span class="math inline">\(I\)</span>-equivalent 的。我们可以翻转任何边的方向，只要不形成 v-structure，那么图的 <span class="math inline">\(d\)</span>-connectivity 将保持不变。</p>

    </div>
</article>

    
        <div id="footer-post-container">
    <div id="footer-post">

        <div id="nav-footer" style="display: none">
            <ul>
                
                    <li><a href="/">Home</a></li>
                
                    <li><a href="/archives/">Articles</a></li>
                
                    <li><a href="/category/">Category</a></li>
                
                    <li><a href="/tags/">Tag</a></li>
                
                    <li><a href="/about/">About</a></li>
                
                    <li><a href="/search/">Search</a></li>
                
            </ul>
        </div>

        <div id="toc-footer" style="display: none">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#贝叶斯网络的概率建模"><span class="toc-number">1.</span> <span class="toc-text">贝叶斯网络的概率建模</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#图的表示"><span class="toc-number">1.1.</span> <span class="toc-text">图的表示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#正式定义"><span class="toc-number">1.2.</span> <span class="toc-text">正式定义</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#贝叶斯网络的依赖关系"><span class="toc-number">2.</span> <span class="toc-text">贝叶斯网络的依赖关系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#有向图描述的独立变量"><span class="toc-number">2.1.</span> <span class="toc-text">有向图描述的独立变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有向图的表示能力"><span class="toc-number">2.2.</span> <span class="toc-text">有向图的表示能力</span></a></li></ol></li></ol>
        </div>

        <div id="share-footer" style="display: none">
            <ul>
    <li><a class="icon"
           href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.tsinghua2018.top/2020/05/11/cs228_representation_bayesian_networks/&title=『CS228笔记』Representaion ── Bayesian Networks"><i
                    class="fab fa-qq fa-lg" aria-hidden="true"></i></a></li>
    <li><a class="icon"
           href="https://service.weibo.com/share/share.php?url=http://blog.tsinghua2018.top/2020/05/11/cs228_representation_bayesian_networks/&title=『CS228笔记』Representaion ── Bayesian Networks"><i
                    class="fab fa-weibo fa-lg" aria-hidden="true"></i></a></li>
    <li><a class="icon" href="https://twitter.com/share?url=http://blog.tsinghua2018.top/2020/05/11/cs228_representation_bayesian_networks/&text=『CS228笔记』Representaion ── Bayesian Networks" target="_blank" rel="noopener"><i
                    class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
    <li><a class="icon" href="mailto:?subject=『CS228笔记』Representaion ── Bayesian Networks&body=Check out this article: http://blog.tsinghua2018.top/2020/05/11/cs228_representation_bayesian_networks/"><i
                    class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
</ul>
        </div>

        <div id="actions-footer">
            <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i
                        class="fas fa-bars fa-lg"
                        aria-hidden="true"></i> Menu</a>
            <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i
                        class="fas fa-list fa-lg"
                        aria-hidden="true"></i> TOC</a>
            <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i
                        class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
            <a id="top" style="display:none" class="icon" href="#"
               onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg"
                                                                               aria-hidden="true"></i> Top
            </a>
        </div>

    </div>
</div>
    
    <footer id="footer">
    <div class="footer-left">
        Copyright &copy; 2020 <i class="fas fa-heart"></i>
        David
        
    </div>
    <!-- <div class="footer-right">
    <nav>
      <ul>
        
        <li><a href="/">Home</a></li>
        
        <li><a href="/archives/">Articles</a></li>
        
        <li><a href="/category/">Category</a></li>
        
        <li><a href="/tags/">Tag</a></li>
        
        <li><a href="/about/">About</a></li>
        
        <li><a href="/search/">Search</a></li>
        
      </ul>
    </nav>
  </div> -->

    <div class="footer-custom">
        Framework by <a href="https://hexo.io" target="_blank">Hexo</a> & Theme by <a
                href="https://github.com/xuthus5/hexo-theme-cactus" target="_blank">Cactus-CN</a>
        
    </div>
</footer>
</div>
<!-- styles -->

<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css">


<link rel="stylesheet" href="https://cdn.staticfile.org/justifiedGallery/3.7.0/css/justifiedGallery.min.css">

<!-- jquery -->

<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>


<script src="https://cdn.staticfile.org/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

    
<script src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script>

    <script type="text/javascript">
        $(function () {
            // copy-btn HTML
            var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
            btn += '<i class="far fa-clone"></i>';
            btn += '</span>';
            // mount it!
            $(".highlight .code pre").before(btn);
            var clip = new ClipboardJS('.btn-copy', {
                target: function (trigger) {
                    return trigger.nextElementSibling;
                }
            });
            clip.on('success', function (e) {
                e.trigger.setAttribute('aria-label', "Copied!");
                e.clearSelection();
            })
        })
    </script>


<script src="/js/main.js"></script>

<!-- search -->


    

        

        
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css" crossorigin="anonymous">
            <script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js" crossorigin="anonymous"></script>
            <script
                    defer
                    src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"
                    crossorigin="anonymous"
                    onload="renderMathInElement(document.body)">
            </script>
        

    

</body>

</html>